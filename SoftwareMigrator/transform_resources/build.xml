<project default="transform_and_gen">
	<target name="transform_and_gen">
		<epsilon.xml.loadModel name="INPUT" file="/Users/sophie/eclipse-projects/thesis/transform_v2/test/input_xml/case_study_arduino_netlist.xml" read="true" store="false" />
		<epsilon.xml.loadModel name="CONFIG" file="/Users/sophie/eclipse-projects/thesis/transform_v2/test/test_config.xml" read="true" store="true" />
		<epsilon.emf.loadModel name="TRANSFORM" modelfile="temp/output.model" metamodelfile="metamodel/metamodel_v2.ecore" read="false" store="false" />

		<!-- Apply transformation -->
		<epsilon.etl src="xml_to_model/xml_to_model.etl">
			<model ref="INPUT" as="XML" />
			<model ref="TRANSFORM" as="OUT" />
			<model ref="CONFIG" />
		</epsilon.etl>
		
		<!-- Create output file if it doesn't exist -->
		<touch file="generated_code/output.cpp" mkdirs="true"/>
		
		<!-- Generate code -->
		<epsilon.egl src="model_to_cpp/generate_skeleton.egl" target="generated_code/output.cpp">
			<model ref="TRANSFORM" />
			<model ref="CONFIG" as="X" />
		</epsilon.egl>
	</target>
</project>

